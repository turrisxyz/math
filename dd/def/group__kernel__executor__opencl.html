<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Stan Math Library: Kernel Executor</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../$standoxy.css" rel="stylesheet" type="text/css">
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../stanlogo-main.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"><a href="https://mc-stan.org/math">Stan Math Library</a>
   &#160;<span id="projectnumber">4.3.2</span>
   </div>
   <div id="projectbrief">Automatic Differentiation</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('dd/def/group__kernel__executor__opencl.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Kernel Executor<div class="ingroups"><a class="el" href="../../d5/de5/group__opencl.html">OpenCL</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>The kernel executor allows OpenCL kernels to be executed in async. GPUs have the capability to perform reads, writes, and computation at the same time. In order to maximize the throughput to the device the Kernel Executor assigns matrices read and write events. Write events are blocking in that no further operations can be completed until the write event is finished. However, read events can happen in async together. Take the following for example. </p>
<div class="fragment"><div class="line">matrix_cl&lt;double&gt; A = from_eigen_cl(A_eig);</div>
<div class="line">matrix_cl&lt;double&gt; B = from_eigen_cl(B_eig);</div>
<div class="line">matrix_cl&lt;double&gt; C = A * B;</div>
<div class="line">matrix_cl&lt;double&gt; D = A + B;</div>
<div class="line">matrix_cl&lt;double&gt; E = C + D;</div>
</div><!-- fragment --><p>In the above, When <code>A</code> and <code>B</code> are created from the <a class="el" href="../../d0/da5/namespace_eigen.html">Eigen</a> matrices <code>A_eig</code> and <code>B_eig</code>. they are both assigned write events to their write event stack. <code>C</code> and <code>D</code> depend on <code>A</code> and <code>B</code> while <code>E</code> depends on <code>C</code> and <code>D</code>. When executing <code>C</code>'s operation, <code>A</code> and <code>B</code> are assigned events to their read event stack while <code>C</code> is assigned an event to it's write event stack. Once <code>A</code> and <code>B</code> have finished their write event the kernel to compute <code>C</code> can begin. The excution to create <code>D</code> also waits for the write events of <code>A</code> and <code>B</code>, but does not have to wait for the execution of <code>C</code> to finish. Executing <code>E</code> requires waiting for for the write events of both <code>C</code> and <code>D</code>. </p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:d4/db4/structstan_1_1math_1_1opencl__kernels_1_1in__buffer"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/def/group__kernel__executor__opencl.html#d4/db4/structstan_1_1math_1_1opencl__kernels_1_1in__buffer">stan::math::opencl_kernels::in_buffer</a></td></tr>
<tr class="separator:d4/db4/structstan_1_1math_1_1opencl__kernels_1_1in__buffer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d7/d46/structstan_1_1math_1_1opencl__kernels_1_1out__buffer"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/def/group__kernel__executor__opencl.html#d7/d46/structstan_1_1math_1_1opencl__kernels_1_1out__buffer">stan::math::opencl_kernels::out_buffer</a></td></tr>
<tr class="separator:d7/d46/structstan_1_1math_1_1opencl__kernels_1_1out__buffer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:da/dc4/structstan_1_1math_1_1opencl__kernels_1_1in__out__buffer"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/def/group__kernel__executor__opencl.html#da/dc4/structstan_1_1math_1_1opencl__kernels_1_1in__out__buffer">stan::math::opencl_kernels::in_out_buffer</a></td></tr>
<tr class="separator:da/dc4/structstan_1_1math_1_1opencl__kernels_1_1in__out__buffer"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gad5621902e224a5a5392177af1277d440"><td class="memTemplParams" colspan="2">template&lt;typename T , require_not_matrix_cl_t&lt; T &gt; *  = nullptr&gt; </td></tr>
<tr class="memitem:gad5621902e224a5a5392177af1277d440"><td class="memTemplItemLeft" align="right" valign="top">const T &amp;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../dd/def/group__kernel__executor__opencl.html#gad5621902e224a5a5392177af1277d440">stan::math::opencl_kernels::internal::get_kernel_args</a> (const T &amp;t)</td></tr>
<tr class="separator:gad5621902e224a5a5392177af1277d440"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7c3311ccc70e1ad81e34261c4a2247cd"><td class="memTemplParams" colspan="2">template&lt;typename K , require_matrix_cl_t&lt; K &gt; *  = nullptr&gt; </td></tr>
<tr class="memitem:ga7c3311ccc70e1ad81e34261c4a2247cd"><td class="memTemplItemLeft" align="right" valign="top">const cl::Buffer &amp;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../dd/def/group__kernel__executor__opencl.html#ga7c3311ccc70e1ad81e34261c4a2247cd">stan::math::opencl_kernels::internal::get_kernel_args</a> (const K &amp;m)</td></tr>
<tr class="separator:ga7c3311ccc70e1ad81e34261c4a2247cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga69d3eac49b859fa73316f720f8c20884"><td class="memTemplParams" colspan="2">template&lt;typename T , require_not_matrix_cl_t&lt; T &gt; *  = nullptr&gt; </td></tr>
<tr class="memitem:ga69d3eac49b859fa73316f720f8c20884"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../dd/def/group__kernel__executor__opencl.html#ga69d3eac49b859fa73316f720f8c20884">stan::math::opencl_kernels::internal::assign_event</a> (const cl::Event &amp;<a class="el" href="../../d4/d84/namespacestan_1_1math.html#a3a7127a28f51e5042f0bc4301409dd2f">e</a>, const T &amp;)</td></tr>
<tr class="separator:ga69d3eac49b859fa73316f720f8c20884"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab77d2bced7523577868c95c209125856"><td class="memTemplParams" colspan="2">template&lt;typename T , require_same_t&lt; T, cl::Event &gt; *  = nullptr&gt; </td></tr>
<tr class="memitem:gab77d2bced7523577868c95c209125856"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../dd/def/group__kernel__executor__opencl.html#gab77d2bced7523577868c95c209125856">stan::math::opencl_kernels::internal::assign_events</a> (const T &amp;)</td></tr>
<tr class="separator:gab77d2bced7523577868c95c209125856"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9372072266513935a5d9dcde1d679568"><td class="memTemplParams" colspan="2">template&lt;typename T , require_not_matrix_cl_t&lt; T &gt; *  = nullptr&gt; </td></tr>
<tr class="memitem:ga9372072266513935a5d9dcde1d679568"><td class="memTemplItemLeft" align="right" valign="top">std::vector&lt; cl::Event &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../dd/def/group__kernel__executor__opencl.html#ga9372072266513935a5d9dcde1d679568">stan::math::opencl_kernels::internal::select_events</a> (const T &amp;m)</td></tr>
<tr class="separator:ga9372072266513935a5d9dcde1d679568"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac66303aa3dbfe61cec066219c97d8fb0"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/def/group__kernel__executor__opencl.html#gac66303aa3dbfe61cec066219c97d8fb0">stan::math::opencl_kernels::compile_kernel</a> (const char *name, const std::vector&lt; std::string &gt; &amp;sources, const std::map&lt; std::string, int &gt; &amp;options)</td></tr>
<tr class="separator:gac66303aa3dbfe61cec066219c97d8fb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaded04f685f322717ff64539c88cda3b0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/def/group__kernel__executor__opencl.html#gaded04f685f322717ff64539c88cda3b0">stan::math::opencl_kernels::kernel_cl&lt; Args &gt;::kernel_cl</a> (const char *name, std::vector&lt; std::string &gt; sources, std::map&lt; std::string, int &gt; options={})</td></tr>
<tr class="separator:gaded04f685f322717ff64539c88cda3b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2edcdc94a69739fd1cfab26c457262eb"><td class="memTemplParams" colspan="2">template&lt;typename... CallArgs&gt; </td></tr>
<tr class="memitem:ga2edcdc94a69739fd1cfab26c457262eb"><td class="memTemplItemLeft" align="right" valign="top">auto&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../dd/def/group__kernel__executor__opencl.html#ga2edcdc94a69739fd1cfab26c457262eb">stan::math::opencl_kernels::kernel_cl&lt; Args &gt;::operator()</a> (cl::NDRange global_thread_size, CallArgs &amp;&amp;... args) const</td></tr>
<tr class="separator:ga2edcdc94a69739fd1cfab26c457262eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga012ee6c8af99cf40c5df26e591ae9a03"><td class="memTemplParams" colspan="2">template&lt;typename... CallArgs&gt; </td></tr>
<tr class="memitem:ga012ee6c8af99cf40c5df26e591ae9a03"><td class="memTemplItemLeft" align="right" valign="top">auto&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../dd/def/group__kernel__executor__opencl.html#ga012ee6c8af99cf40c5df26e591ae9a03">stan::math::opencl_kernels::kernel_cl&lt; Args &gt;::operator()</a> (cl::NDRange global_thread_size, cl::NDRange thread_block_size, CallArgs &amp;&amp;... args) const</td></tr>
<tr class="separator:ga012ee6c8af99cf40c5df26e591ae9a03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab6585fe09d1feeca2af78de1527c1ab3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/def/group__kernel__executor__opencl.html#gab6585fe09d1feeca2af78de1527c1ab3">stan::math::opencl_kernels::kernel_cl&lt; Args &gt;::get_option</a> (const std::string option_name) const</td></tr>
<tr class="separator:gab6585fe09d1feeca2af78de1527c1ab3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<hr/><h2 class="groupheader">Class Documentation</h2>
<a name="d4/db4/structstan_1_1math_1_1opencl__kernels_1_1in__buffer" id="d4/db4/structstan_1_1math_1_1opencl__kernels_1_1in__buffer"></a>
<h2 class="memtitle"><span class="permalink"><a href="#d4/db4/structstan_1_1math_1_1opencl__kernels_1_1in__buffer">&#9670;&nbsp;</a></span>stan::math::opencl_kernels::in_buffer</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct stan::math::opencl_kernels::in_buffer</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a name="d7/d46/structstan_1_1math_1_1opencl__kernels_1_1out__buffer" id="d7/d46/structstan_1_1math_1_1opencl__kernels_1_1out__buffer"></a>
<h2 class="memtitle"><span class="permalink"><a href="#d7/d46/structstan_1_1math_1_1opencl__kernels_1_1out__buffer">&#9670;&nbsp;</a></span>stan::math::opencl_kernels::out_buffer</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct stan::math::opencl_kernels::out_buffer</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a name="da/dc4/structstan_1_1math_1_1opencl__kernels_1_1in__out__buffer" id="da/dc4/structstan_1_1math_1_1opencl__kernels_1_1in__out__buffer"></a>
<h2 class="memtitle"><span class="permalink"><a href="#da/dc4/structstan_1_1math_1_1opencl__kernels_1_1in__out__buffer">&#9670;&nbsp;</a></span>stan::math::opencl_kernels::in_out_buffer</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct stan::math::opencl_kernels::in_out_buffer</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="gaded04f685f322717ff64539c88cda3b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaded04f685f322717ff64539c88cda3b0">&#9670;&nbsp;</a></span>kernel_cl()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename... Args&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d8/d68/structstan_1_1math_1_1opencl__kernels_1_1kernel__cl.html">stan::math::opencl_kernels::kernel_cl</a>&lt; Args &gt;::<a class="el" href="../../d8/d68/structstan_1_1math_1_1opencl__kernels_1_1kernel__cl.html">kernel_cl</a> </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::string &gt;&#160;</td>
          <td class="paramname"><em>sources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::map&lt; std::string, int &gt;&#160;</td>
          <td class="paramname"><em>options</em> = <code>{}</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Creates functor for kernels that only need access to defining the global work size. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>The name for the kernel </td></tr>
    <tr><td class="paramname">sources</td><td>A std::vector of strings containing the code for the kernel. </td></tr>
    <tr><td class="paramname">options</td><td>The values of macros to be passed at compile time. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../dd/d60/kernel__cl_8hpp_source.html#l00189">189</a> of file <a class="el" href="../../dd/d60/kernel__cl_8hpp_source.html">kernel_cl.hpp</a>.</p>

</div>
</div>
<a id="ga69d3eac49b859fa73316f720f8c20884"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga69d3eac49b859fa73316f720f8c20884">&#9670;&nbsp;</a></span>assign_event()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , require_not_matrix_cl_t&lt; T &gt; *  = nullptr&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void stan::math::opencl_kernels::internal::assign_event </td>
          <td>(</td>
          <td class="paramtype">const cl::Event &amp;&#160;</td>
          <td class="paramname"><em>e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const T &amp;&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Assigns the event to a <code><a class="el" href="../../df/d15/classstan_1_1math_1_1matrix__cl.html" title="Represents an arithmetic matrix on the OpenCL device.">matrix_cl</a></code>. </p><dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">T</td><td>The type to be assigned, if not a <a class="el" href="../../df/d15/classstan_1_1math_1_1matrix__cl.html" title="Represents an arithmetic matrix on the OpenCL device.">matrix_cl</a> this function will do nothing. </td></tr>
    <tr><td class="paramname">K</td><td>The type of the <code><a class="el" href="../../df/d15/classstan_1_1math_1_1matrix__cl.html" title="Represents an arithmetic matrix on the OpenCL device.">matrix_cl</a></code>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">e</td><td>The event to be assigned. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../dd/d60/kernel__cl_8hpp_source.html#l00058">58</a> of file <a class="el" href="../../dd/d60/kernel__cl_8hpp_source.html">kernel_cl.hpp</a>.</p>

</div>
</div>
<a id="gab77d2bced7523577868c95c209125856"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab77d2bced7523577868c95c209125856">&#9670;&nbsp;</a></span>assign_events()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , require_same_t&lt; T, cl::Event &gt; *  = nullptr&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void stan::math::opencl_kernels::internal::assign_events </td>
          <td>(</td>
          <td class="paramtype">const T &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Adds the event to any <code>matrix_cls</code> in the arguments depending on whether they are <code><a class="el" href="../../dd/def/group__kernel__executor__opencl.html#d4/db4/structstan_1_1math_1_1opencl__kernels_1_1in__buffer">in_buffer</a></code>, <code><a class="el" href="../../dd/def/group__kernel__executor__opencl.html#d7/d46/structstan_1_1math_1_1opencl__kernels_1_1out__buffer">out_buffer</a></code>, or <code>in_out_buffers</code>. </p><dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Arg</td><td>Arguments given during kernel creation that specify the kernel signature. </td></tr>
    <tr><td class="paramname">Args</td><td>Arguments given during kernel creation that specify the kernel signature. </td></tr>
    <tr><td class="paramname">CallArg</td><td>First argument type used to call the kernel </td></tr>
    <tr><td class="paramname">CallArgs</td><td>Other argument types used to call the kernel. </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">new_event</td><td>The cl::Event generated involving the arguments. </td></tr>
    <tr><td class="paramname">m</td><td>Arguments to the kernel that may be <code>matrix_cls</code> or not. Non-matrices are ignored. </td></tr>
    <tr><td class="paramname">args</td><td>Arguments to the kernel that may be matrices or not. Non-matrices are ignored. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../dd/d60/kernel__cl_8hpp_source.html#l00092">92</a> of file <a class="el" href="../../dd/d60/kernel__cl_8hpp_source.html">kernel_cl.hpp</a>.</p>

</div>
</div>
<a id="gac66303aa3dbfe61cec066219c97d8fb0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac66303aa3dbfe61cec066219c97d8fb0">&#9670;&nbsp;</a></span>compile_kernel()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">auto stan::math::opencl_kernels::compile_kernel </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>sources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::map&lt; std::string, int &gt; &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compile an OpenCL kernel.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>The name for the kernel </td></tr>
    <tr><td class="paramname">sources</td><td>A std::vector of strings containing the code for the kernel. </td></tr>
    <tr><td class="paramname">options</td><td>The values of macros to be passed at compile time. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../dd/d60/kernel__cl_8hpp_source.html#l00136">136</a> of file <a class="el" href="../../dd/d60/kernel__cl_8hpp_source.html">kernel_cl.hpp</a>.</p>

</div>
</div>
<a id="ga7c3311ccc70e1ad81e34261c4a2247cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7c3311ccc70e1ad81e34261c4a2247cd">&#9670;&nbsp;</a></span>get_kernel_args() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename K , require_matrix_cl_t&lt; K &gt; *  = nullptr&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const cl::Buffer&amp; stan::math::opencl_kernels::internal::get_kernel_args </td>
          <td>(</td>
          <td class="paramtype">const K &amp;&#160;</td>
          <td class="paramname"><em>m</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Extracts the kernel's arguments, used in the global and local kernel constructor. </p><dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">K</td><td>The type of the <code><a class="el" href="../../df/d15/classstan_1_1math_1_1matrix__cl.html" title="Represents an arithmetic matrix on the OpenCL device.">matrix_cl</a></code>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">m</td><td>The <code>matrix</code> with an OpenCL Buffer. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The OpenCL Buffer. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../dd/d60/kernel__cl_8hpp_source.html#l00046">46</a> of file <a class="el" href="../../dd/d60/kernel__cl_8hpp_source.html">kernel_cl.hpp</a>.</p>

</div>
</div>
<a id="gad5621902e224a5a5392177af1277d440"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad5621902e224a5a5392177af1277d440">&#9670;&nbsp;</a></span>get_kernel_args() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , require_not_matrix_cl_t&lt; T &gt; *  = nullptr&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const T&amp; stan::math::opencl_kernels::internal::get_kernel_args </td>
          <td>(</td>
          <td class="paramtype">const T &amp;&#160;</td>
          <td class="paramname"><em>t</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Extracts the kernel's arguments, used in the global and local kernel constructor. </p><dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">For</td><td>this general template the function will return back the value passed in. </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">t</td><td>The type that will be returned. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the input t. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../dd/d60/kernel__cl_8hpp_source.html#l00034">34</a> of file <a class="el" href="../../dd/d60/kernel__cl_8hpp_source.html">kernel_cl.hpp</a>.</p>

</div>
</div>
<a id="gab6585fe09d1feeca2af78de1527c1ab3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab6585fe09d1feeca2af78de1527c1ab3">&#9670;&nbsp;</a></span>get_option()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename... Args&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="../../d8/d68/structstan_1_1math_1_1opencl__kernels_1_1kernel__cl.html">stan::math::opencl_kernels::kernel_cl</a>&lt; Args &gt;::get_option </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>option_name</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Retrieves an option used for compiling the kernel. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">option_name</td><td>which option to retrieve </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>option value </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../dd/d60/kernel__cl_8hpp_source.html#l00250">250</a> of file <a class="el" href="../../dd/d60/kernel__cl_8hpp_source.html">kernel_cl.hpp</a>.</p>

</div>
</div>
<a id="ga2edcdc94a69739fd1cfab26c457262eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2edcdc94a69739fd1cfab26c457262eb">&#9670;&nbsp;</a></span>operator()() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename... Args&gt; </div>
<div class="memtemplate">
template&lt;typename... CallArgs&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">auto <a class="el" href="../../d8/d68/structstan_1_1math_1_1opencl__kernels_1_1kernel__cl.html">stan::math::opencl_kernels::kernel_cl</a>&lt; Args &gt;::operator() </td>
          <td>(</td>
          <td class="paramtype">cl::NDRange&#160;</td>
          <td class="paramname"><em>global_thread_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CallArgs &amp;&amp;...&#160;</td>
          <td class="paramname"><em>args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Executes a kernel </p><dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">CallArgs</td><td>The types of the callee arguments. </td></tr>
    <tr><td class="paramname">Args</td><td>Parameter pack of all kernel argument types. </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">global_thread_size</td><td>The global work size. </td></tr>
    <tr><td class="paramname">args</td><td>The arguments to pass to the kernel. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An Opencl event. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../dd/d60/kernel__cl_8hpp_source.html#l00202">202</a> of file <a class="el" href="../../dd/d60/kernel__cl_8hpp_source.html">kernel_cl.hpp</a>.</p>

</div>
</div>
<a id="ga012ee6c8af99cf40c5df26e591ae9a03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga012ee6c8af99cf40c5df26e591ae9a03">&#9670;&nbsp;</a></span>operator()() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename... Args&gt; </div>
<div class="memtemplate">
template&lt;typename... CallArgs&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">auto <a class="el" href="../../d8/d68/structstan_1_1math_1_1opencl__kernels_1_1kernel__cl.html">stan::math::opencl_kernels::kernel_cl</a>&lt; Args &gt;::operator() </td>
          <td>(</td>
          <td class="paramtype">cl::NDRange&#160;</td>
          <td class="paramname"><em>global_thread_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cl::NDRange&#160;</td>
          <td class="paramname"><em>thread_block_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CallArgs &amp;&amp;...&#160;</td>
          <td class="paramname"><em>args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Executes a kernel </p><dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">CallArgs</td><td>The types of the callee arguments. </td></tr>
    <tr><td class="paramname">Args</td><td>Parameter pack of all kernel argument types. </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">global_thread_size</td><td>The global work size. </td></tr>
    <tr><td class="paramname">thread_block_size</td><td>The thread block size. </td></tr>
    <tr><td class="paramname">args</td><td>The arguments to pass to the kernel. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An Opencl event. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../dd/d60/kernel__cl_8hpp_source.html#l00228">228</a> of file <a class="el" href="../../dd/d60/kernel__cl_8hpp_source.html">kernel_cl.hpp</a>.</p>

</div>
</div>
<a id="ga9372072266513935a5d9dcde1d679568"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9372072266513935a5d9dcde1d679568">&#9670;&nbsp;</a></span>select_events()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , require_not_matrix_cl_t&lt; T &gt; *  = nullptr&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;cl::Event&gt; stan::math::opencl_kernels::internal::select_events </td>
          <td>(</td>
          <td class="paramtype">const T &amp;&#160;</td>
          <td class="paramname"><em>m</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Select events from kernel arguments. Does nothing for non <code><a class="el" href="../../df/d15/classstan_1_1math_1_1matrix__cl.html" title="Represents an arithmetic matrix on the OpenCL device.">matrix_cl</a></code> types. </p><dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">T</td><td>The argument type for a non <code><a class="el" href="../../df/d15/classstan_1_1math_1_1matrix__cl.html" title="Represents an arithmetic matrix on the OpenCL device.">matrix_cl</a></code>, else the in/out/in_out buffer types. </td></tr>
    <tr><td class="paramname">K</td><td>The type of the <code><a class="el" href="../../df/d15/classstan_1_1math_1_1matrix__cl.html" title="Represents an arithmetic matrix on the OpenCL device.">matrix_cl</a></code> </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">m</td><td>If an <code><a class="el" href="../../df/d15/classstan_1_1math_1_1matrix__cl.html" title="Represents an arithmetic matrix on the OpenCL device.">matrix_cl</a></code>, gets the event vector, else this argument does nothing. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A vector of OpenCL events. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../dd/d60/kernel__cl_8hpp_source.html#l00112">112</a> of file <a class="el" href="../../dd/d60/kernel__cl_8hpp_source.html">kernel_cl.hpp</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->

<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">
    <div class="contents" style="font-size:100%;">
      <span style="float:left; margin=0 1em 0 1em;">
      &nbsp;&nbsp;&nbsp;&nbsp;
      [ <a href="http://mc-stan.org/">Stan Home Page</a> ]
      </span>
      <span style="float:right; margin=0 1em 0 1em;">
      <i>&copy; 2011&ndash;2019,
      Stan Development Team.
      &nbsp;&nbsp;&nbsp;&nbsp;
      </i>
      </span>
    </div> </li>
  </ul>
</div>
</body>
</html>
